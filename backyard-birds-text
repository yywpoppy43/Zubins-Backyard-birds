<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backyard Birds of Woodside - Interactive Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: linear-gradient(to bottom, #87CEEB 0%, #B8E6F0 30%, #98D8C8 60%, #6B8E23 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .forest-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* Animated clouds */
        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 100px;
            animation: float linear infinite;
            filter: blur(2px);
        }

        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 100px;
        }

        @keyframes float {
            from { transform: translateX(-200px); }
            to { transform: translateX(calc(100vw + 200px)); }
        }

        /* Tree layers */
        .tree-layer {
            position: absolute;
            bottom: 0;
            width: 100%;
            pointer-events: none;
        }

        .tree {
            position: absolute;
            bottom: 0;
            transition: transform 0.3s ease;
        }

        .tree:hover {
            transform: scale(1.05);
        }

        /* Birds flying across */
        .flying-bird {
            position: fixed;
            font-size: 24px;
            animation: fly linear infinite;
            z-index: 1;
            pointer-events: none;
        }

        @keyframes fly {
            from { 
                transform: translateX(-100px) translateY(0px);
            }
            to { 
                transform: translateX(calc(100vw + 100px)) translateY(-50px);
            }
        }

        /* Grass animation */
        .grass {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 150px;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 3px,
                rgba(107, 142, 35, 0.3) 3px,
                rgba(107, 142, 35, 0.3) 6px
            );
            animation: sway 3s ease-in-out infinite;
        }

        @keyframes sway {
            0%, 100% { transform: skewX(0deg); }
            50% { transform: skewX(1deg); }
        }

        /* Sun/Moon */
        .celestial {
            position: fixed;
            top: 80px;
            right: 100px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle, #FFD700 0%, #FFA500 100%);
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
            animation: pulse 4s ease-in-out infinite;
            z-index: 1;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        /* Butterflies */
        .butterfly {
            position: fixed;
            font-size: 20px;
            animation: butterfly-flight 15s ease-in-out infinite;
            z-index: 1;
            pointer-events: none;
        }

        @keyframes butterfly-flight {
            0% { 
                transform: translate(0, 0) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translate(80vw, 60vh) rotate(360deg);
                opacity: 0;
            }
        }

        header {
            position: relative;
            z-index: 10;
            text-align: center;
            padding: 25px 15px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-bottom: 3px solid #6B8E23;
        }

        h1 {
            font-size: 2em;
            color: #2d5016;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 0.95em;
            color: #5a7c3e;
            font-style: italic;
            line-height: 1.4;
            padding: 0 10px;
        }

        .attribution {
            font-size: 0.85em;
            color: #888;
            margin-top: 8px;
        }

        .container {
            position: relative;
            z-index: 5;
            max-width: 100%;
            margin: 15px auto;
            padding: 10px;
        }

        .birds-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            padding: 10px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .bird-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border: 2px solid #e0e0e0;
            position: relative;
            min-height: 280px;
        }

        .bird-card:active {
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .bird-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            border-color: #6B8E23;
        }

        .bird-illustration {
            width: 140px;
            height: 140px;
            margin: 5px auto 12px;
            position: relative;
        }

        .bird-name {
            font-size: 1.1em;
            font-weight: 600;
            color: #2d5016;
            margin-bottom: 5px;
            letter-spacing: 0.3px;
            line-height: 1.3;
        }

        .scientific-name {
            font-size: 0.85em;
            font-style: italic;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.2;
        }

        .click-hint {
            font-size: 0.8em;
            color: #888;
            margin-top: 8px;
            padding: 6px;
            background: rgba(107, 142, 35, 0.1);
            border-radius: 8px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: linear-gradient(135deg, #fff 0%, #f8fdf8 100%);
            margin: 5% auto;
            padding: 25px 20px;
            border: 4px solid #6B8E23;
            border-radius: 20px;
            width: 95%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
            animation: slideIn 0.4s;
            -webkit-overflow-scrolling: touch;
        }

        @keyframes slideIn {
            from { transform: translateY(-60px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            color: #999;
            float: right;
            font-size: 36px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
            line-height: 1;
            padding: 0 8px;
        }

        .close:hover,
        .close:focus {
            color: #333;
        }

        .modal-bird-illustration {
            width: 200px;
            height: 200px;
            margin: 15px auto;
            display: block;
        }

        .modal h2 {
            color: #2d5016;
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.8em;
            font-weight: normal;
            line-height: 1.3;
        }

        .modal .scientific-name {
            text-align: center;
            font-size: 1.05em;
            margin-bottom: 20px;
        }

        .play-sound-btn {
            display: block;
            margin: 20px auto;
            padding: 15px 35px;
            background: linear-gradient(135deg, #6B8E23 0%, #8FBC8F 100%);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1.05em;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            font-weight: 600;
            width: 90%;
            max-width: 300px;
        }

        .play-sound-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, #7BA32E 0%, #9FCC9F 100%);
        }

        .play-sound-btn:active:not(:disabled) {
            transform: scale(0.98);
        }

        .play-sound-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .sound-status {
            text-align: center;
            font-size: 0.85em;
            color: #666;
            margin-top: 10px;
            font-style: italic;
        }

        .info-section {
            margin: 18px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border-left: 5px solid #6B8E23;
        }

        .info-section h3 {
            color: #2d5016;
            margin-bottom: 10px;
            font-size: 1.2em;
            font-weight: 600;
        }

        .info-section p, .info-section ul {
            color: #333;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .info-section ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .info-section li {
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .subtitle {
                font-size: 0.9em;
            }
            
            .birds-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 12px;
                padding: 8px;
            }
            
            .bird-card {
                padding: 12px;
                min-height: 250px;
            }
            
            .bird-illustration {
                width: 120px;
                height: 120px;
            }
            
            .modal-content {
                width: 98%;
                padding: 20px 15px;
                margin: 2% auto;
            }
            
            .modal-bird-illustration {
                width: 180px;
                height: 180px;
            }
            
            .modal h2 {
                font-size: 1.5em;
            }
            
            .close {
                font-size: 32px;
            }

            .celestial {
                width: 60px;
                height: 60px;
                top: 60px;
                right: 20px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.5em;
            }

            .subtitle {
                font-size: 0.85em;
            }
            
            .birds-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                padding: 5px;
            }

            .bird-card {
                padding: 10px;
                min-height: 230px;
            }

            .bird-illustration {
                width: 110px;
                height: 110px;
            }

            .bird-name {
                font-size: 1em;
            }

            .scientific-name {
                font-size: 0.75em;
            }

            .click-hint {
                font-size: 0.75em;
                padding: 5px;
            }

            .modal-content {
                padding: 15px 12px;
            }

            .modal-bird-illustration {
                width: 160px;
                height: 160px;
            }

            .modal h2 {
                font-size: 1.3em;
            }

            .info-section {
                padding: 12px;
                margin: 15px 0;
            }

            .info-section h3 {
                font-size: 1.1em;
            }

            .info-section p, .info-section ul {
                font-size: 0.9em;
            }

            .play-sound-btn {
                padding: 12px 25px;
                font-size: 0.95em;
            }

            .celestial {
                width: 50px;
                height: 50px;
                top: 50px;
                right: 15px;
            }

            /* Reduce forest animations for better mobile performance */
            .flying-bird, .butterfly {
                display: none;
            }

            .cloud {
                animation-duration: 80s !important;
            }
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .leaf {
            position: fixed;
            pointer-events: none;
            z-index: 2;
            font-size: 20px;
            opacity: 0.4;
        }
    </style>
</head>
<body>
    <div class="forest-background" id="forestBg"></div>
    <div class="celestial"></div>
    
    <header>
        <h1>Backyard Birds of Woodside</h1>
        <p class="subtitle">An Interactive Guide to Local Birds - Click any bird to learn more and hear authentic calls!</p>
        <p class="attribution">Art and Design by Robin Lazzara</p>
    </header>

    <div class="container">
        <div class="birds-grid" id="birdsGrid"></div>
    </div>

    <div id="birdModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        const birds = [
            {
                number: 1,
                name: "Bewick's Wren",
                scientific: "Thryomanes bewickii",
                colors: { body: "#8B7355", wing: "#6B5945", breast: "#E8D8C8", accent: "#FFFFFF", tail: "#5A4A3A" },
                // Bewick's Wren: 2 sec song with 2-5 high intro notes, buzzes, and deliberate trill ending at 3.3-4.1 kHz
                soundPattern: [
                    {type: 'pure', freq: 3800, duration: 0.12},
                    {type: 'pure', freq: 3700, duration: 0.12},
                    {type: 'buzz', freq: 3400, duration: 0.15},
                    {type: 'buzz', freq: 3200, duration: 0.12},
                    {type: 'warble', freqStart: 3500, freqEnd: 3900, duration: 0.25},
                    {type: 'trill', freq: 3600, duration: 0.4, rate: 15}
                ],
                diet: "Primarily insects and spiders",
                habitat: "Brushy areas, thickets, and suburban gardens",
                size: "5.1 inches long",
                characteristics: "A small, energetic bird with a long tail often held upright and a distinctive white eyebrow stripe.",
                behavior: "Very active and curious, often seen hopping through brush and low vegetation. Sings a beautiful, variable song from exposed perches.",
                funFacts: [
                    "Named after Thomas Bewick, an English engraver and naturalist",
                    "Males may build several 'dummy' nests before the female chooses one",
                    "Their tail constantly flicks and moves as they forage"
                ]
            },
            {
                number: 2,
                name: "Anna's Hummingbird",
                scientific: "Calypte anna",
                colors: { body: "#4CAF50", wing: "#2E7D32", breast: "#C2185B", accent: "#FF1744", throat: "#E91E63" },
                // Anna's Hummingbird: Rapid high-pitched chips and buzzy notes 4-5.5 kHz
                soundPattern: [
                    {type: 'chip', freq: 5200, duration: 0.03},
                    {type: 'chip', freq: 5400, duration: 0.03},
                    {type: 'buzz', freq: 4800, duration: 0.08},
                    {type: 'chip', freq: 5100, duration: 0.03},
                    {type: 'chip', freq: 5300, duration: 0.03},
                    {type: 'buzz', freq: 4600, duration: 0.08},
                    {type: 'chip', freq: 5500, duration: 0.03}
                ],
                diet: "Nectar from flowers and small insects",
                habitat: "Gardens, parks, and coastal scrub",
                size: "3.9 inches long",
                characteristics: "Males have iridescent rose-pink throats and crowns that can appear red or gold in different lighting.",
                behavior: "Extremely territorial and aggressive despite their tiny size. Males perform dramatic dive displays during courtship.",
                funFacts: [
                    "One of the few hummingbirds that stays year-round in California",
                    "Can fly backwards and hover in place",
                    "Their heart beats up to 1,260 times per minute"
                ]
            },
            {
                number: 3,
                name: "Oak Titmouse",
                scientific: "Baeolophus inornatus",
                colors: { body: "#A9A9A9", wing: "#8B8B8B", breast: "#C8C8C8", accent: "#696969", crest: "#909090" },
                // Oak Titmouse: Repeated whistled notes, 3-4 kHz
                soundPattern: [
                    {type: 'whistle', freq: 3400, duration: 0.18},
                    {type: 'whistle', freq: 3200, duration: 0.18},
                    {type: 'whistle', freq: 3400, duration: 0.18},
                    {type: 'whistle', freq: 3100, duration: 0.2}
                ],
                diet: "Insects, spiders, seeds, and acorns",
                habitat: "Oak woodlands and mixed forests",
                size: "5-5.5 inches long",
                characteristics: "A plain gray-brown bird with a small crest and large dark eyes.",
                behavior: "Active and acrobatic, often hanging upside down while foraging. Forms pairs that stay together year-round.",
                funFacts: [
                    "Endemic to California - found nowhere else in the world",
                    "Stores food in bark crevices for later",
                    "Pairs often stay together for life"
                ]
            },
            {
                number: 4,
                name: "Lesser Goldfinch",
                scientific: "Spinus psaltria",
                colors: { body: "#FFD700", wing: "#000000", breast: "#FFED4E", accent: "#FFFFFF", cap: "#1C1C1C" },
                // Lesser Goldfinch: Complex twittering song with imitations, 3-5 kHz
                soundPattern: [
                    {type: 'twitter', freqStart: 3800, freqEnd: 4400, duration: 0.25},
                    {type: 'pure', freq: 4200, duration: 0.08},
                    {type: 'pure', freq: 4400, duration: 0.08},
                    {type: 'twitter', freqStart: 3600, freqEnd: 4600, duration: 0.3},
                    {type: 'pure', freq: 4000, duration: 0.1}
                ],
                diet: "Seeds, especially from sunflowers and thistles",
                habitat: "Open woodlands, gardens, and weedy fields",
                size: "3.5-4.5 inches long",
                characteristics: "Males are bright yellow below with either black or olive-green backs. White wing patches are visible in flight.",
                behavior: "Often seen in flocks feeding on seed heads. Very social and may visit feeders in groups.",
                funFacts: [
                    "Can imitate other bird songs",
                    "Males sing while flying",
                    "Often feeds while hanging upside down"
                ]
            },
            {
                number: 5,
                name: "Chestnut-backed Chickadee",
                scientific: "Poecile rufescens",
                colors: { body: "#8B4513", wing: "#A0522D", breast: "#FFFFFF", accent: "#000000", back: "#A0522D" },
                // Chestnut-backed Chickadee: Higher, hoarser "chick-a-dee-dee", 3-4.5 kHz
                soundPattern: [
                    {type: 'pure', freq: 4200, duration: 0.1},
                    {type: 'pure', freq: 3800, duration: 0.08},
                    {type: 'dee', freq: 3400, duration: 0.12},
                    {type: 'dee', freq: 3400, duration: 0.12},
                    {type: 'dee', freq: 3400, duration: 0.12}
                ],
                diet: "Insects, spiders, seeds, and berries",
                habitat: "Coniferous and mixed forests",
                size: "4.5 inches long",
                characteristics: "Black cap and bib, white cheeks, and distinctive rich chestnut back and sides.",
                behavior: "Acrobatic foragers, often hanging upside down on branches. Very social and often joins mixed-species flocks.",
                funFacts: [
                    "Can remember thousands of hiding spots where they cached food",
                    "The only chickadee species on the Pacific Coast",
                    "Communal roosters in winter to stay warm"
                ]
            },
            {
                number: 6,
                name: "Western Scrub-Jay",
                scientific: "Aphelocoma californica",
                colors: { body: "#4169E1", wing: "#1E3A8A", breast: "#E0E0E0", accent: "#0D47A1", head: "#4169E1" },
                // Western Scrub-Jay: Harsh "shreep" calls, 1.5-2.5 kHz
                soundPattern: [
                    {type: 'harsh', freq: 2000, duration: 0.2},
                    {type: 'harsh', freq: 2200, duration: 0.18},
                    {type: 'harsh', freq: 2000, duration: 0.22},
                    {type: 'rattle', freq: 1800, duration: 0.15}
                ],
                diet: "Acorns, insects, small animals, and bird eggs",
                habitat: "Oak woodlands, suburban areas, and chaparral",
                size: "11 inches long",
                characteristics: "Bright blue head, wings, and tail with gray-brown back and white underparts. No crest.",
                behavior: "Intelligent and bold. Known to cache thousands of acorns each fall. Can recognize individual humans.",
                funFacts: [
                    "Can remember where they buried thousands of acorns",
                    "May live up to 15 years",
                    "Will mob predators like hawks and owls"
                ]
            },
            {
                number: 7,
                name: "Golden-crowned Sparrow",
                scientific: "Zonotrichia atricapilla",
                colors: { body: "#8B7355", wing: "#6B5945", breast: "#C0C0C0", accent: "#FFD700", crown: "#DAA520" },
                // Golden-crowned Sparrow: "Oh dear me" - 3 descending whistles, 2-3 kHz
                soundPattern: [
                    {type: 'whistle', freq: 2800, duration: 0.35},
                    {type: 'whistle', freq: 2400, duration: 0.35},
                    {type: 'whistle', freq: 2000, duration: 0.4}
                ],
                diet: "Seeds, buds, flowers, and insects",
                habitat: "Dense shrubs, chaparral, and gardens",
                size: "7 inches long",
                characteristics: "Black and yellow striped crown in breeding plumage. Gray breast and brown streaked back.",
                behavior: "Often forages on the ground in flocks during winter. Hops rather than walks.",
                funFacts: [
                    "Song sounds like 'Oh dear me'",
                    "Breeds in Alaska and far northern Canada",
                    "Can live up to 10 years"
                ]
            },
            {
                number: 8,
                name: "White-crowned Sparrow",
                scientific: "Zonotrichia leucophrys",
                colors: { body: "#8B7355", wing: "#6B5945", breast: "#D3D3D3", accent: "#FFFFFF", crown: "#F5F5F5" },
                // White-crowned Sparrow: Clear whistles then buzzy trill, 2.5-4 kHz
                soundPattern: [
                    {type: 'pure', freq: 3400, duration: 0.22},
                    {type: 'buzz', freq: 3000, duration: 0.15},
                    {type: 'trill', freq: 2800, duration: 0.35, rate: 18},
                    {type: 'buzz', freq: 2500, duration: 0.18}
                ],
                diet: "Seeds, grains, and insects",
                habitat: "Brushy areas, gardens, and woodland edges",
                size: "7 inches long",
                characteristics: "Bold black and white head stripes. Pink or yellowish bill. Gray underparts.",
                behavior: "Forages on the ground, often scratching in leaf litter. Sings a distinctive whistled song.",
                funFacts: [
                    "Dialects vary by region, like human accents",
                    "Young birds learn songs from adults",
                    "Can live up to 13 years in the wild"
                ]
            },
            {
                number: 9,
                name: "Purple Finch",
                scientific: "Haemorhous purpureus",
                colors: { body: "#8B2252", wing: "#722243", breast: "#C2185B", accent: "#FFFFFF", head: "#8B2252" },
                // Purple Finch: Rich warbling song, 2.5-4.5 kHz
                soundPattern: [
                    {type: 'warble', freqStart: 2800, freqEnd: 4200, duration: 0.45},
                    {type: 'pure', freq: 3800, duration: 0.1},
                    {type: 'warble', freqStart: 3000, freqEnd: 4500, duration: 0.4},
                    {type: 'pure', freq: 3400, duration: 0.12}
                ],
                diet: "Seeds, buds, and berries",
                habitat: "Coniferous forests and suburban areas",
                size: "6 inches long",
                characteristics: "Males are raspberry-red, especially on head and breast. Females are brown-streaked with a bold face pattern.",
                behavior: "Often visits feeders. Males sing a rich, warbling song from treetops.",
                funFacts: [
                    "Not actually purple, but raspberry-colored",
                    "Numbers have declined in recent decades",
                    "May irrupt southward in winter when food is scarce"
                ]
            },
            {
                number: 10,
                name: "House Finch",
                scientific: "Haemorhous mexicanus",
                colors: { body: "#8B4513", wing: "#6B3410", breast: "#CD5C5C", accent: "#FFFFFF", head: "#CD5C5C" },
                // House Finch: Long jumbled warbling, 2-4 kHz
                soundPattern: [
                    {type: 'warble', freqStart: 2600, freqEnd: 3800, duration: 0.55},
                    {type: 'pure', freq: 3200, duration: 0.1},
                    {type: 'warble', freqStart: 2800, freqEnd: 4000, duration: 0.5},
                    {type: 'buzz', freq: 3000, duration: 0.15}
                ],
                diet: "Seeds, fruits, and buds",
                habitat: "Urban and suburban areas",
                size: "5.5 inches long",
                characteristics: "Males have red head, breast, and rump. Females are grayish-brown with streaks.",
                behavior: "Very common at feeders. Gregarious and often in flocks. Sings a long, jumbled warbling song.",
                funFacts: [
                    "Originally from the western US, introduced to eastern US in 1940",
                    "Male's red color comes from pigments in their diet",
                    "Can nest year-round in mild climates"
                ]
            },
            {
                number: 11,
                name: "Western Bluebird",
                scientific: "Sialia mexicana",
                colors: { body: "#0000FF", wing: "#00008B", breast: "#FF6347", accent: "#1E90FF", back: "#4169E1" },
                // Western Bluebird: Soft "pew" and warbled songs, 2.5-3.5 kHz
                soundPattern: [
                    {type: 'pure', freq: 3200, duration: 0.15},
                    {type: 'warble', freqStart: 2800, freqEnd: 3400, duration: 0.3},
                    {type: 'pure', freq: 3000, duration: 0.15},
                    {type: 'warble', freqStart: 2600, freqEnd: 3200, duration: 0.25}
                ],
                diet: "Insects and berries",
                habitat: "Open woodlands, farmlands, and suburbs",
                size: "7 inches long",
                characteristics: "Males are bright blue above with rusty-orange breast and shoulders. Females are grayer with hints of blue.",
                behavior: "Perches in the open and drops to catch insects. Nests in cavities and readily uses nest boxes.",
                funFacts: [
                    "Often helps raise siblings from previous broods",
                    "Populations rebounded thanks to nest box programs",
                    "Pairs may stay together for multiple breeding seasons"
                ]
            },
            {
                number: 12,
                name: "Spotted Towhee",
                scientific: "Pipilo maculatus",
                colors: { body: "#000000", wing: "#2F2F2F", breast: "#CD853F", accent: "#FFFFFF", side: "#D2691E" },
                // Spotted Towhee: Buzzy trill, 2-3 kHz
                soundPattern: [
                    {type: 'buzz', freq: 2400, duration: 0.22},
                    {type: 'trill', freq: 2600, duration: 0.35, rate: 12},
                    {type: 'buzz', freq: 2300, duration: 0.18}
                ],
                diet: "Insects, seeds, and berries",
                habitat: "Dense thickets and woodland edges",
                size: "8.5 inches long",
                characteristics: "Black head, back, and tail with rufous sides and white belly. White spots on wings and back.",
                behavior: "Forages on the ground by kicking backward with both feet simultaneously.",
                funFacts: [
                    "Their 'kick-scratching' behavior is unique among birds",
                    "Call sounds like 'chewink' or 'towhee'",
                    "Often skulks in dense brush"
                ]
            },
            {
                number: 13,
                name: "White-breasted Nuthatch",
                scientific: "Sitta carolinensis",
                colors: { body: "#708090", wing: "#4682B4", breast: "#FFFFFF", accent: "#000000", cap: "#2F4F4F" },
                // White-breasted Nuthatch: Nasal "yank yank", 2.5-3 kHz
                soundPattern: [
                    {type: 'nasal', freq: 2800, duration: 0.13},
                    {type: 'nasal', freq: 2800, duration: 0.13},
                    {type: 'nasal', freq: 2800, duration: 0.13},
                    {type: 'nasal', freq: 2800, duration: 0.13}
                ],
                diet: "Insects, seeds, and nuts",
                habitat: "Deciduous and mixed forests",
                size: "5.5 inches long",
                characteristics: "Blue-gray back, black cap, and white face and breast. Short tail and long pointed bill.",
                behavior: "Climbs down tree trunks head-first. Uses bill to wedge nuts into bark crevices and hack them open.",
                funFacts: [
                    "Only bird that regularly climbs down trees head-first",
                    "Smears insects around nest entrance to deter predators",
                    "Caches food year-round"
                ]
            },
            {
                number: 14,
                name: "Dark-eyed Junco",
                scientific: "Junco hyemalis",
                colors: { body: "#696969", wing: "#505050", breast: "#FFFFFF", accent: "#D3D3D3", hood: "#4A4A4A" },
                // Dark-eyed Junco: Musical trill, 3-4 kHz
                soundPattern: [
                    {type: 'trill', freq: 3400, duration: 0.9, rate: 14},
                    {type: 'pure', freq: 3600, duration: 0.1}
                ],
                diet: "Seeds and insects",
                habitat: "Forests, parks, and gardens",
                size: "6 inches long",
                characteristics: "Slate-gray overall with white belly and outer tail feathers that flash white in flight. Pink bill.",
                behavior: "Forages on the ground, often in flocks. Hops rather than walks. Common at feeders in winter.",
                funFacts: [
                    "Sometimes called 'snowbirds' because they appear in winter",
                    "One of the most abundant birds in North America",
                    "Several distinct color forms across their range"
                ]
            },
            {
                number: 15,
                name: "Black-headed Grosbeak",
                scientific: "Pheucticus melanocephalus",
                colors: { body: "#FF8C00", wing: "#000000", breast: "#FFA500", accent: "#FFFFFF", head: "#1C1C1C" },
                // Black-headed Grosbeak: Robin-like caroling song, 2-4 kHz
                soundPattern: [
                    {type: 'carol', freqStart: 2400, freqEnd: 3800, duration: 0.65},
                    {type: 'pure', freq: 3200, duration: 0.12},
                    {type: 'carol', freqStart: 2600, freqEnd: 4000, duration: 0.6},
                    {type: 'pure', freq: 2800, duration: 0.15}
                ],
                diet: "Insects, seeds, and berries",
                habitat: "Deciduous and mixed woodlands",
                size: "8 inches long",
                characteristics: "Males have black head, orange breast and collar, and black and white wings. Thick conical bill.",
                behavior: "Sings a beautiful, robin-like song. Males and females both sing. Often sings while incubating eggs.",
                funFacts: [
                    "Can eat toxic monarch butterflies without harm",
                    "Both parents incubate eggs and sing on the nest",
                    "Winters in Mexico"
                ]
            },
            {
                number: 16,
                name: "California Towhee",
                scientific: "Melozone crissalis",
                colors: { body: "#8B7355", wing: "#6B5945", breast: "#A0826D", accent: "#CD853F", undertail: "#8B4513" },
                // California Towhee: Metallic "chink" calls, 2-2.5 kHz
                soundPattern: [
                    {type: 'chip', freq: 2400, duration: 0.1},
                    {type: 'chip', freq: 2400, duration: 0.1},
                    {type: 'chip', freq: 2400, duration: 0.1},
                    {type: 'trill', freq: 2200, duration: 0.25, rate: 10}
                ],
                diet: "Seeds, berries, and insects",
                habitat: "Chaparral, gardens, and parks",
                size: "9 inches long",
                characteristics: "Uniformly gray-brown with rusty undertail coverts. Long tail and conical bill.",
                behavior: "Ground forager that scratches in leaf litter. Often seen in pairs. Very territorial.",
                funFacts: [
                    "Pairs mate for life and defend territories year-round",
                    "Endemic to California and southwestern Oregon",
                    "Often quite tame around humans"
                ]
            },
            {
                number: 17,
                name: "Acorn Woodpecker",
                scientific: "Melanerpes formicivorus",
                colors: { body: "#000000", wing: "#2F2F2F", breast: "#FFFFFF", accent: "#FF0000", face: "#FAFAFA" },
                // Acorn Woodpecker: Loud "waka-waka" laughing calls, 2-3 kHz
                soundPattern: [
                    {type: 'loud', freq: 2600, duration: 0.15},
                    {type: 'loud', freq: 2800, duration: 0.15},
                    {type: 'loud', freq: 2600, duration: 0.15},
                    {type: 'rattle', freq: 2700, duration: 0.45, rate: 18}
                ],
                diet: "Acorns, insects, sap, and fruit",
                habitat: "Oak woodlands",
                size: "9 inches long",
                characteristics: "Clownish face pattern with red crown, white face, and black around eyes. Black back with white rump.",
                behavior: "Lives in cooperative family groups. Famous for creating 'granary trees' where they store thousands of acorns.",
                funFacts: [
                    "A single granary tree may have 50,000 holes",
                    "Lives in family groups with multiple breeders",
                    "Can be quite noisy and raucous"
                ]
            },
            {
                number: 18,
                name: "Hermit Thrush",
                scientific: "Catharus guttatus",
                colors: { body: "#8B7355", wing: "#704214", breast: "#F5DEB3", accent: "#CD853F", tail: "#A0522D" },
                // Hermit Thrush: Ethereal flutelike song, 3-5 kHz descending
                soundPattern: [
                    {type: 'flute', freq: 4200, duration: 0.35},
                    {type: 'flute', freq: 3600, duration: 0.32},
                    {type: 'flute', freq: 3000, duration: 0.35},
                    {type: 'warble', freqStart: 3200, freqEnd: 4400, duration: 0.45}
                ],
                diet: "Insects and berries",
                habitat: "Forests and woodlands",
                size: "6.75 inches long",
                characteristics: "Brown above with spotted breast. Distinctive reddish tail that it slowly raises and lowers.",
                behavior: "Often forages on the forest floor. Has one of the most beautiful songs of any North American bird.",
                funFacts: [
                    "State bird of Vermont",
                    "Song inspired Walt Whitman's poetry",
                    "Characteristically flicks tail and wings"
                ]
            },
            {
                number: 19,
                name: "American Robin",
                scientific: "Turdus migratorius",
                colors: { body: "#696969", wing: "#505050", breast: "#DC143C", accent: "#FFFFFF", head: "#2F2F2F" },
                // American Robin: Cheerful caroling "cheerily-cheer-up", 2-4 kHz
                soundPattern: [
                    {type: 'carol', freq: 2600, duration: 0.25},
                    {type: 'carol', freq: 3000, duration: 0.25},
                    {type: 'carol', freq: 2800, duration: 0.25},
                    {type: 'carol', freq: 3200, duration: 0.25},
                    {type: 'carol', freq: 2400, duration: 0.3}
                ],
                diet: "Earthworms, insects, and berries",
                habitat: "Lawns, parks, and forests",
                size: "10 inches long",
                characteristics: "Gray-brown above with brick-red breast. White around eyes and throat.",
                behavior: "Often seen running across lawns, stopping to cock head and look for earthworms.",
                funFacts: [
                    "Can eat up to 14 feet of earthworms per day",
                    "Not actually 'listening' for worms - they're looking for them",
                    "One of the first birds to sing at dawn"
                ]
            },
            {
                number: 20,
                name: "California Quail",
                scientific: "Callipepla californica",
                colors: { body: "#708090", wing: "#4682B4", breast: "#D3D3D3", accent: "#000000", belly: "#B8B8B8" },
                // California Quail: "Chi-ca-go" assembly call, 1.5-2.5 kHz
                soundPattern: [
                    {type: 'call', freq: 1900, duration: 0.18},
                    {type: 'call', freq: 2200, duration: 0.22},
                    {type: 'call', freq: 1800, duration: 0.28},
                    {type: 'chip', freq: 2400, duration: 0.12}
                ],
                diet: "Seeds, leaves, and berries",
                habitat: "Chaparral, woodlands, and suburban areas",
                size: "10 inches long",
                characteristics: "Plump ground bird with distinctive teardrop-shaped head plume. Gray and brown plumage with scaled belly.",
                behavior: "Highly social, living in groups called coveys. Often seen running rather than flying. Roosts in trees at night.",
                funFacts: [
                    "State bird of California",
                    "Chicks can run right after hatching",
                    "Coveys can contain 25-40 birds in winter"
                ]
            }
        ];

        // Enhanced bird sound synthesis with authentic patterns
        function playBirdSound(bird) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const masterGain = audioContext.createGain();
            masterGain.connect(audioContext.destination);
            masterGain.gain.value = 0.25;

            let currentTime = audioContext.currentTime + 0.1;

            bird.soundPattern.forEach((note, index) => {
                const startTime = currentTime;
                
                switch(note.type) {
                    case 'pure':
                        createPureTone(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'chirp':
                    case 'chip':
                        createChirp(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'trill':
                        createTrill(audioContext, masterGain, note.freq, note.duration, startTime, note.rate || 15);
                        break;
                    case 'warble':
                        createWarble(audioContext, masterGain, note.freqStart, note.freqEnd, note.duration, startTime);
                        break;
                    case 'buzz':
                        createBuzz(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'whistle':
                        createWhistle(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'nasal':
                        createNasal(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'flute':
                        createFlute(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'carol':
                        if (note.freqStart && note.freqEnd) {
                            createCarolPhrase(audioContext, masterGain, note.freqStart, note.freqEnd, note.duration, startTime);
                        } else {
                            createCarol(audioContext, masterGain, note.freq, note.duration, startTime);
                        }
                        break;
                    case 'harsh':
                        createHarsh(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'loud':
                        createLoud(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'rattle':
                        createRattle(audioContext, masterGain, note.freq, note.duration, startTime, note.rate || 15);
                        break;
                    case 'call':
                        createCall(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                    case 'twitter':
                        createTwitter(audioContext, masterGain, note.freqStart, note.freqEnd, note.duration, startTime);
                        break;
                    case 'dee':
                        createDee(audioContext, masterGain, note.freq, note.duration, startTime);
                        break;
                }
                
                currentTime = startTime + note.duration + 0.05;
            });
        }

        // Sound generation functions
        function createPureTone(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, startTime);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.7, startTime + 0.02);
            gain.gain.setValueAtTime(0.7, startTime + duration - 0.03);
            gain.gain.linearRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createChirp(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, startTime);
            osc.frequency.exponentialRampToValueAtTime(freq * 0.85, startTime + duration);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.8, startTime + 0.005);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createTrill(ctx, dest, freq, duration, startTime, rate) {
            const pulseWidth = 1 / rate;
            const numPulses = Math.floor(duration / pulseWidth);
            for (let i = 0; i < numPulses; i++) {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.type = 'sine';
                const freqVar = freq + (Math.random() * 100 - 50);
                osc.frequency.setValueAtTime(freqVar, startTime + i * pulseWidth);
                gain.gain.setValueAtTime(0.6, startTime + i * pulseWidth);
                gain.gain.exponentialRampToValueAtTime(0.01, startTime + i * pulseWidth + pulseWidth * 0.8);
                osc.connect(gain);
                gain.connect(dest);
                osc.start(startTime + i * pulseWidth);
                osc.stop(startTime + i * pulseWidth + pulseWidth * 0.8);
            }
        }

        function createWarble(ctx, dest, freqStart, freqEnd, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freqStart, startTime);
            const steps = 25;
            for (let i = 0; i < steps; i++) {
                const t = startTime + (duration * i / steps);
                const progress = i / steps;
                const f = freqStart + ((freqEnd - freqStart) * (Math.sin(progress * Math.PI * 3) + progress) / 2);
                osc.frequency.setValueAtTime(f, t);
            }
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.5, startTime + 0.03);
            gain.gain.setValueAtTime(0.5, startTime + duration - 0.05);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createBuzz(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(freq, startTime);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.35, startTime + 0.01);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createWhistle(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, startTime);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.55, startTime + 0.05);
            gain.gain.setValueAtTime(0.55, startTime + duration - 0.05);
            gain.gain.linearRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createNasal(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(freq, startTime);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.28, startTime + 0.02);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createFlute(ctx, dest, freq, duration, startTime) {
            const osc1 = ctx.createOscillator();
            const osc2 = ctx.createOscillator();
            const gain = ctx.createGain();
            osc1.type = 'sine';
            osc2.type = 'sine';
            osc1.frequency.setValueAtTime(freq, startTime);
            osc2.frequency.setValueAtTime(freq * 2, startTime);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.35, startTime + 0.06);
            gain.gain.setValueAtTime(0.35, startTime + duration - 0.1);
            gain.gain.linearRampToValueAtTime(0.01, startTime + duration);
            osc1.connect(gain);
            osc2.connect(gain);
            gain.connect(dest);
            osc1.start(startTime);
            osc2.start(startTime);
            osc1.stop(startTime + duration);
            osc2.stop(startTime + duration);
        }

        function createCarol(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, startTime);
            osc.frequency.linearRampToValueAtTime(freq * 1.08, startTime + duration/2);
            osc.frequency.linearRampToValueAtTime(freq * 0.98, startTime + duration);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.55, startTime + 0.04);
            gain.gain.setValueAtTime(0.55, startTime + duration - 0.06);
            gain.gain.linearRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createCarolPhrase(ctx, dest, freqStart, freqEnd, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freqStart, startTime);
            const steps = 15;
            for (let i = 0; i < steps; i++) {
                const t = startTime + (duration * i / steps);
                const progress = i / steps;
                const f = freqStart + ((freqEnd - freqStart) * (Math.sin(progress * Math.PI * 2) * 0.3 + progress));
                osc.frequency.setValueAtTime(f, t);
            }
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.5, startTime + 0.05);
            gain.gain.setValueAtTime(0.5, startTime + duration - 0.08);
            gain.gain.linearRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createHarsh(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(freq, startTime);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.45, startTime + 0.02);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createLoud(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'square';
            osc.frequency.setValueAtTime(freq, startTime);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.6, startTime + 0.01);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createRattle(ctx, dest, freq, duration, startTime, rate) {
            const pulseWidth = 1 / rate;
            const numPulses = Math.floor(duration / pulseWidth);
            for (let i = 0; i < numPulses; i++) {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.type = 'square';
                osc.frequency.setValueAtTime(freq + (Math.random() * 150 - 75), startTime + i * pulseWidth);
                gain.gain.setValueAtTime(0.35, startTime + i * pulseWidth);
                gain.gain.exponentialRampToValueAtTime(0.01, startTime + i * pulseWidth + pulseWidth * 0.7);
                osc.connect(gain);
                gain.connect(dest);
                osc.start(startTime + i * pulseWidth);
                osc.stop(startTime + i * pulseWidth + pulseWidth * 0.7);
            }
        }

        function createCall(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, startTime);
            osc.frequency.linearRampToValueAtTime(freq * 1.15, startTime + duration/3);
            osc.frequency.linearRampToValueAtTime(freq * 0.92, startTime + duration);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.5, startTime + 0.02);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        function createTwitter(ctx, dest, freqStart, freqEnd, duration, startTime) {
            const numNotes = 8;
            const noteLength = duration / numNotes;
            for (let i = 0; i < numNotes; i++) {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.type = 'sine';
                const freq = freqStart + ((freqEnd - freqStart) * (i / numNotes)) + (Math.random() * 200 - 100);
                osc.frequency.setValueAtTime(freq, startTime + i * noteLength);
                gain.gain.setValueAtTime(0.4, startTime + i * noteLength);
                gain.gain.exponentialRampToValueAtTime(0.01, startTime + i * noteLength + noteLength * 0.9);
                osc.connect(gain);
                gain.connect(dest);
                osc.start(startTime + i * noteLength);
                osc.stop(startTime + i * noteLength + noteLength * 0.9);
            }
        }

        function createDee(ctx, dest, freq, duration, startTime) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, startTime);
            osc.frequency.exponentialRampToValueAtTime(freq * 0.9, startTime + duration);
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.45, startTime + 0.01);
            gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            osc.connect(gain);
            gain.connect(dest);
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        // Create detailed, realistic bird illustrations using canvas
        function createBirdSVG(bird, size = 180) {
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size;
            const ctx = canvas.getContext('2d');
            
            // Scale for drawing
            const scale = size / 180;
            ctx.scale(scale, scale);
            
            // Anti-aliasing
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            
            // Draw based on bird species characteristics
            drawBird(ctx, bird);
            
            return canvas;
        }

        function drawBird(ctx, bird) {
            ctx.save();
            
            // Draw tail first (background layer)
            ctx.fillStyle = bird.colors.tail || bird.colors.wing;
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1.5;
            ctx.beginPath();
            ctx.ellipse(50, 120, 18, 45, -0.5, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Add tail feather details
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 1;
            for (let i = 0; i < 4; i++) {
                ctx.beginPath();
                ctx.moveTo(50, 100 + i * 10);
                ctx.lineTo(50, 130 + i * 10);
                ctx.stroke();
            }
            
            // Draw body
            ctx.fillStyle = bird.colors.body;
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.ellipse(90, 100, 35, 42, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Draw breast overlay
            ctx.fillStyle = bird.colors.breast;
            ctx.beginPath();
            ctx.ellipse(75, 110, 22, 30, -0.2, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw wing
            ctx.fillStyle = bird.colors.wing;
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1.5;
            ctx.beginPath();
            ctx.ellipse(105, 100, 28, 40, 0.3, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Wing feather details
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 1.2;
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.moveTo(100, 75 + i * 10);
                ctx.lineTo(115, 72 + i * 10);
                ctx.stroke();
            }
            
            // Draw neck
            ctx.fillStyle = bird.colors.body;
            ctx.beginPath();
            ctx.ellipse(90, 68, 20, 18, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw head
            ctx.fillStyle = bird.colors.head || bird.colors.body;
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(90, 50, 25, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Draw eye
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(100, 47, 5, 0, Math.PI * 2);
            ctx.fill();
            
            // Eye highlight
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(102, 45, 2, 0, Math.PI * 2);
            ctx.fill();
            
            // Eye ring for some species
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 1.5;
            ctx.beginPath();
            ctx.arc(100, 47, 7, 0, Math.PI * 2);
            ctx.stroke();
            
            // Draw beak
            ctx.fillStyle = '#D97000';
            ctx.strokeStyle = '#8B4500';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(115, 50);
            ctx.lineTo(135, 48);
            ctx.lineTo(115, 54);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Accent markings (spots/patches)
            if (bird.colors.accent && bird.colors.accent !== '#FFFFFF') {
                ctx.fillStyle = bird.colors.accent;
                
                // Wing bars or spots
                ctx.beginPath();
                ctx.arc(108, 90, 5, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(108, 105, 4, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(108, 118, 4, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Crown/cap for some species
            if (bird.colors.crown || bird.colors.cap) {
                ctx.fillStyle = bird.colors.crown || bird.colors.cap;
                ctx.beginPath();
                ctx.ellipse(90, 40, 18, 12, 0, Math.PI, Math.PI * 2);
                ctx.fill();
            }
            
            // Draw legs
            ctx.strokeStyle = '#6B4423';
            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            
            // Left leg
            ctx.beginPath();
            ctx.moveTo(75, 140);
            ctx.lineTo(70, 165);
            ctx.stroke();
            
            // Left foot
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(70, 165);
            ctx.lineTo(62, 168);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(70, 165);
            ctx.lineTo(78, 168);
            ctx.stroke();
            
            // Right leg
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(90, 140);
            ctx.lineTo(95, 165);
            ctx.stroke();
            
            // Right foot
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(95, 165);
            ctx.lineTo(87, 168);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(95, 165);
            ctx.lineTo(103, 168);
            ctx.stroke();
            
            // Add texture with subtle gradients
            const gradient = ctx.createRadialGradient(85, 100, 10, 85, 100, 40);
            gradient.addColorStop(0, 'rgba(255, 255, 255, 0.15)');
            gradient.addColorStop(1, 'rgba(0, 0, 0, 0.1)');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.ellipse(90, 100, 35, 42, 0, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        }

        // Create bird cards
        function loadBirds() {
            const birdsGrid = document.getElementById('birdsGrid');
            
            birds.forEach(bird => {
                const card = document.createElement('div');
                card.className = 'bird-card';
                
                const birdCanvas = createBirdSVG(bird);
                birdCanvas.className = 'bird-illustration';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'bird-name';
                nameDiv.textContent = bird.name;
                
                const scientificDiv = document.createElement('div');
                scientificDiv.className = 'scientific-name';
                scientificDiv.textContent = bird.scientific;
                
                const hintDiv = document.createElement('div');
                hintDiv.className = 'click-hint';
                hintDiv.textContent = '🎵 Click to hear authentic bird call!';
                
                card.appendChild(birdCanvas);
                card.appendChild(nameDiv);
                card.appendChild(scientificDiv);
                card.appendChild(hintDiv);
                
                card.onclick = () => showBirdInfo(bird);
                birdsGrid.appendChild(card);
            });
        }

        // Modal functionality
        const modal = document.getElementById('birdModal');
        const closeBtn = document.getElementsByClassName('close')[0];
        let isPlaying = false;

        closeBtn.onclick = function() {
            modal.style.display = 'none';
            isPlaying = false;
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = 'none';
                isPlaying = false;
            }
        }

        function showBirdInfo(bird) {
            isPlaying = false;
            const modalContent = document.getElementById('modalContent');
            
            // Use smaller bird image for mobile
            const isMobile = window.innerWidth <= 768;
            const birdSize = isMobile ? 180 : 200;
            const birdCanvas = createBirdSVG(bird, birdSize);
            birdCanvas.className = 'modal-bird-illustration';
            
            modalContent.innerHTML = `
                <h2>${bird.name}</h2>
                <div class="scientific-name">${bird.scientific}</div>
                
                <button class="play-sound-btn" id="playSoundBtn">
                    🎵 Play ${bird.name} Call
                </button>
                <div class="sound-status">Synthesized based on ornithological recordings</div>

                <div class="info-section">
                    <h3>📏 Size</h3>
                    <p>${bird.size}</p>
                </div>

                <div class="info-section">
                    <h3>🎨 Characteristics</h3>
                    <p>${bird.characteristics}</p>
                </div>

                <div class="info-section">
                    <h3>🍽️ Diet</h3>
                    <p>${bird.diet}</p>
                </div>

                <div class="info-section">
                    <h3>🏡 Habitat</h3>
                    <p>${bird.habitat}</p>
                </div>

                <div class="info-section">
                    <h3>🎭 Behavior</h3>
                    <p>${bird.behavior}</p>
                </div>

                <div class="info-section">
                    <h3>✨ Fun Facts</h3>
                    <ul>
                        ${bird.funFacts.map(fact => `<li>${fact}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            // Insert canvas at the top
            modalContent.insertBefore(birdCanvas, modalContent.firstChild);
            
            modal.style.display = 'block';
            
            const playBtn = document.getElementById('playSoundBtn');
            playBtn.onclick = () => {
                if (!isPlaying) {
                    isPlaying = true;
                    playBtn.disabled = true;
                    playBtn.textContent = `🔊 Playing...`;
                    playBirdSound(bird);
                    setTimeout(() => {
                        isPlaying = false;
                        playBtn.disabled = false;
                        playBtn.textContent = `🎵 Play ${bird.name} Call`;
                    }, 3000);
                }
            };
        }

        // Create interactive forest background
        function createForest() {
            const forestBg = document.getElementById('forestBg');
            
            // Create clouds
            for (let i = 0; i < 5; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                const size = Math.random() * 60 + 40;
                cloud.style.width = size + 'px';
                cloud.style.height = size * 0.6 + 'px';
                cloud.style.top = Math.random() * 30 + 5 + '%';
                cloud.style.left = Math.random() * 100 + '%';
                cloud.style.animationDuration = (Math.random() * 40 + 60) + 's';
                cloud.style.animationDelay = Math.random() * -30 + 's';
                
                // Cloud puffs
                const beforeSize = size * 0.6;
                cloud.style.setProperty('--before-size', beforeSize + 'px');
                cloud.innerHTML = `<style>
                    .cloud:nth-child(${i+1})::before {
                        width: ${beforeSize}px;
                        height: ${beforeSize}px;
                        top: -${beforeSize * 0.3}px;
                        left: ${size * 0.2}px;
                    }
                    .cloud:nth-child(${i+1})::after {
                        width: ${beforeSize * 0.8}px;
                        height: ${beforeSize * 0.8}px;
                        top: -${beforeSize * 0.2}px;
                        right: ${size * 0.2}px;
                    }
                </style>`;
                
                forestBg.appendChild(cloud);
            }
            
            // Create trees using canvas
            const treeLayers = [
                { count: 8, bottom: 0, minHeight: 200, maxHeight: 300, opacity: 0.3 },
                { count: 6, bottom: 50, minHeight: 180, maxHeight: 250, opacity: 0.5 },
                { count: 5, bottom: 100, minHeight: 150, maxHeight: 200, opacity: 0.7 }
            ];
            
            treeLayers.forEach((layer, layerIndex) => {
                const treeLayer = document.createElement('div');
                treeLayer.className = 'tree-layer';
                treeLayer.style.bottom = layer.bottom + 'px';
                treeLayer.style.opacity = layer.opacity;
                
                for (let i = 0; i < layer.count; i++) {
                    const tree = createTreeCanvas(layer.minHeight, layer.maxHeight);
                    tree.className = 'tree';
                    tree.style.left = (i / layer.count * 100) + Math.random() * 10 + '%';
                    tree.style.zIndex = -layerIndex - 1;
                    treeLayer.appendChild(tree);
                }
                
                forestBg.appendChild(treeLayer);
            });
            
            // Create grass
            const grass = document.createElement('div');
            grass.className = 'grass';
            forestBg.appendChild(grass);
            
            // Create flying birds
            setInterval(() => {
                const bird = document.createElement('div');
                bird.className = 'flying-bird';
                bird.innerHTML = '🦅';
                bird.style.top = Math.random() * 40 + 10 + '%';
                bird.style.fontSize = Math.random() * 20 + 15 + 'px';
                bird.style.animationDuration = Math.random() * 15 + 20 + 's';
                document.body.appendChild(bird);
                
                setTimeout(() => bird.remove(), 35000);
            }, 8000);
            
            // Create butterflies
            setInterval(() => {
                const butterfly = document.createElement('div');
                butterfly.className = 'butterfly';
                butterfly.innerHTML = '🦋';
                butterfly.style.left = Math.random() * 30 + '%';
                butterfly.style.top = Math.random() * 50 + 20 + '%';
                butterfly.style.animationDuration = Math.random() * 10 + 10 + 's';
                butterfly.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(butterfly);
                
                setTimeout(() => butterfly.remove(), 20000);
            }, 5000);
        }
        
        function createTreeCanvas(minHeight, maxHeight) {
            const canvas = document.createElement('canvas');
            const height = Math.random() * (maxHeight - minHeight) + minHeight;
            const width = height * 0.6;
            canvas.width = width;
            canvas.height = height;
            
            const ctx = canvas.getContext('2d');
            
            // Tree trunk
            const trunkWidth = width * 0.15;
            ctx.fillStyle = '#5D4037';
            ctx.fillRect((width - trunkWidth) / 2, height * 0.6, trunkWidth, height * 0.4);
            
            // Tree foliage (layered triangles)
            const foliageColors = ['#2D5016', '#3A6B1F', '#4A7B2F'];
            
            for (let i = 0; i < 3; i++) {
                ctx.fillStyle = foliageColors[i % foliageColors.length];
                ctx.beginPath();
                ctx.moveTo(width * 0.5, height * 0.1 + i * height * 0.15);
                ctx.lineTo(width * 0.1, height * 0.5 + i * height * 0.15);
                ctx.lineTo(width * 0.9, height * 0.5 + i * height * 0.15);
                ctx.closePath();
                ctx.fill();
            }
            
            return canvas;
        }

        // Add floating leaves animation
        function createLeaves() {
            for (let i = 0; i < 12; i++) {
                const leaf = document.createElement('div');
                leaf.className = 'leaf';
                leaf.innerHTML = ['🍂', '🍃'][Math.floor(Math.random() * 2)];
                leaf.style.left = Math.random() * 100 + '%';
                leaf.style.top = -50 + 'px';
                leaf.style.animation = `fall ${Math.random() * 8 + 8}s linear infinite`;
                leaf.style.animationDelay = Math.random() * 5 + 's';
                document.body.appendChild(leaf);
            }
        }

        // Initialize
        createForest();
        loadBirds();
        createLeaves();
    </script>
</body>
</html>
